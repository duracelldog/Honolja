<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="firstlist">

<select resultType="com.guest.honolja.list.ListDTO" id="selectAll">
	select * from (
	select rownum as rn, g.*,
	(select min(r_price) from roominfo where g_no = g.g_no) as low_price,
    (select count(*) from review where g_no = g.g_no) as reviewcnt
	from guesthouse g where g_name like '%'|| #{sval} || '%' or g_addr like '%' || #{sval} || '%'
	) where low_price between #{startprice} and #{endprice} order by ${filter} ${range}
</select>

	
<select resultType="com.guest.honolja.list.ListDTO" id="selectlo">
	select * from (
	select rownum as rn, g.*,
	(select min(r_price) from roominfo where g_no = g.g_no) as low_price,
	(select count(*) from review where g_no = g.g_no) as reviewcnt
	from guesthouse g where g_addr like '%'|| #{g_addr} || '%'
	) where low_price between #{startprice} and #{endprice} order by ${filter} ${range}
</select>

<!-- select * from ( select rownum rn, g_no, g_name, g_addr, g_position_n, g_detail, g_url, g_position_e 
	from(select * from guesthouse where g_addr like '%'|| #{g_addr} || '%'))  -->
	
<select resultType="int" id="countAll" parameterType="com.guest.honolja.list.ListDTO"> 
	select count(*) from guesthouse where g_name like '%' || #{sval} || '%' 
</select>

</mapper>